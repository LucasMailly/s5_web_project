{% extends 'base.html.twig' %}

{% block title %}Article{% endblock %}

{% block body %}
    <h1 class="mt-3 mx-5">Article</h1>

    {% if is_granted('ROLE_USER') and article.author == app.user and not is_granted('ROLE_BLOCKED')%}
        <a href="{{ path('app_article_edit', {'id': article.id}) }}">Modifier</a>
    {% endif %}

    <table class="table">
        <tbody>
            <tr>
                <th>Titre</th>
                <td>{{ article.title }}</td>
            </tr>
            <tr>
                <th>ImgArticle</th>
                <td><img src="{{ asset(article_images_path ~ (article.imgArticle ? article.imgArticle : 'default.jpg')) }}" alt="imgArticle" width="100" height="100"></td>
            </tr>
            <tr>
                <th>Prix</th>
                <td>{{ article.price }} €</td>
            </tr>
            <tr>
                <th>Date de parution</th>
                <td>{{ article.dateParution ? article.dateParution|date('Y-m-d') : '' }}</td>
            </tr>
            <tr>
                <th>Categorie</th>
                <td>{{ article.category.name }}</td>
            </tr>
            <tr>
                <th>Négotiation</th>
                <td>{{ article.negotiation ? 'Yes' : 'No' }}</td>
            </tr>
            <tr>
                <th>Occasion</th>
                <td>{{ article.used ? 'Yes' : 'No' }}</td>
            </tr>
            <tr>
                <th>Quantité</th>
                <td>{{ article.quantity }}
                    {# read and display just one flash message type #}
                    {% for message in app.flashes('notice') %}
                        <div class="flash-notice">
                            {{ message }}
                        </div>
                    {% endfor %}
                </td>
            </tr>
            <tr>
                <th>
                <a href="{{ path('app_article_add', {'id': article.id, 'add': 'ajouterFavoris'}) }}"> ♥ Favoris</a>
                </th>
                <th>
                <a href="{{ path('app_article_drop', {'id': article.id, 'drop': 'retirerFavoris'}) }}"> ♡ Retirer </a>
                </th>
            </tr>
        </tbody>
    </table>

    {# Seller informations #}
    <h2>Informations du vendeur</h2>
    <table class="table">
        <tbody>
            <tr>
                <td><img src="{{ asset(avatars_path ~ (article.author.avatar ? article.author.avatar : 'default.jpg')) }}" alt="avatar" width="100" height="100"></td>
            </tr>
            <tr>
                <th>Nom</th>
                <td>{{ article.author.name }}</td>
            </tr>
            <tr>
                <th>Email</th>
                <td>{{ article.author.email }}</td>
            </tr>
            <tr>
                <th>Téléphone</th>
                <td>{{ article.author.phone }}</td>
            </tr>
        </tbody>
    </table>


    {% if is_granted('ROLE_USER') and article.author == app.user %}
        {% if not is_granted('ROLE_BLOCKED') %}
            {# Add/remove quantity #}
            <a href="{{ path('app_article_update_quantity', {'id': article.id, 'update': 'plus'}) }}">Stock +1</a>
            <a href="{{ path('app_article_update_quantity', {'id': article.id, 'update': 'minus'}) }}">Stock -1</a>
        {% endif %}
        <br>
        <a href="{{ path('app_article_dashboard') }}">Retour au tableau de board</a>

        {{ include('article/_delete_form.html.twig') }}
    {% endif %}
{% endblock %}
